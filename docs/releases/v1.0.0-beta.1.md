# Release Notes - v1.0.0-beta.1 (Beta)

**Release Date:** October 26, 2025

## What's Changed

### Initial Beta Release

This is the **first beta release** of the ABB/FIMER PVI VSN REST integration for Home Assistant. This new integration provides native REST API support for ABB/FIMER/Power-One inverters via VSN300 and VSN700 dataloggers.

This integration supersedes the `ha-abb-powerone-pvi-sunspec` integration for users with VSN dataloggers, providing:
- Native REST API support (no Modbus required)
- Better VSN300/VSN700 compatibility
- Cleaner architecture and focused development

## New Features

### VSN300/VSN700 Support

- **VSN300 REST API Client**
  - HTTP Digest authentication with X-Digest scheme
  - Support for `/v1/status`, `/v1/livedata`, and `/v1/feeds` endpoints
  - Automatic device detection and metadata extraction

- **VSN700 REST API Client**
  - HTTP Basic authentication
  - Support for `/v1/livedata` and `/v1/feeds` endpoints
  - Device detection via REST API responses

- **Automatic VSN Model Detection**
  - Auto-detects VSN300 vs VSN700 based on API responses
  - Adapts authentication and endpoint usage accordingly

### Integration Features

- **Config Flow**
  - Initial setup with host, username, password configuration
  - Reconfigure support for changing connection parameters
  - Options flow for adjusting scan interval
  - Automatic VSN model detection during setup

- **Data Coordinator**
  - Periodic data polling with configurable scan interval (default: 60s)
  - Robust error handling and retry logic
  - Efficient data caching and update propagation

- **Sensor Platform**
  - Dynamic entity creation based on available data points
  - Automatic unit conversion and data normalization
  - VSN→SunSpec data mapping for standardized entity names

- **Data Normalization**
  - VSN data points mapped to SunSpec schema
  - Consistent entity naming across different VSN models
  - Home Assistant entity metadata (units, device_class, state_class)

### Testing & Development

- **Standalone Test Script** (`vsn_client.py`)
  - Comprehensive testing tool for debugging VSN connections
  - Tests authentication, status, livedata, feeds, and normalization
  - Generates JSON output files for analysis
  - Detailed documentation in `VSN_CLIENT_README.md`

- **Exception Hierarchy**
  - `VSNClientError` - Base exception class
  - `VSNConnectionError` - Connection failures
  - `VSNAuthenticationError` - Authentication failures
  - Proper error propagation to Home Assistant

## Code Quality

- **Type Hints** - Complete type annotations throughout codebase
- **Async/Await** - Full async implementation for non-blocking I/O
- **Ruff Compliance** - All code passes ruff linting checks
- **Home Assistant Standards** - Follows HA integration best practices

## Dependencies

- **aiohttp** >= 3.9.0 - Async HTTP client for REST API communication
- **Home Assistant** >= 2024.1.0 - Core platform

## Installation

### HACS (Recommended)

1. Add this repository as a custom repository in HACS
2. Install "ABB/FIMER PVI VSN REST" from HACS
3. Restart Home Assistant
4. Add integration via UI: Settings → Devices & Services → Add Integration → ABB/FIMER PVI VSN REST

### Manual Installation

1. Copy the `custom_components/abb_fimer_pvi_vsn_rest` directory to your Home Assistant `custom_components` folder
2. Restart Home Assistant
3. Add integration via UI

## Configuration

### Required Parameters

- **Host:** IP address or hostname of your VSN datalogger
- **Username:** Your VSN datalogger username
- **Password:** Your VSN datalogger password

### Optional Parameters

- **Scan Interval:** Polling frequency in seconds (default: 60, range: 30-600)

### Auto-Detected

- **VSN Model:** Automatically detected (VSN300 or VSN700)

## Upgrade Notes

### For New Users

This is the initial release. Simply follow the installation instructions above.

### Migration from ha-abb-powerone-pvi-sunspec

If you're currently using the `ha-abb-powerone-pvi-sunspec` integration with a VSN datalogger:

1. **Keep existing integration** - The old integration will continue to work
2. **When ready to migrate:**
   - Install this new integration alongside the old one
   - Configure it with your VSN datalogger credentials
   - Test that data is being collected correctly
   - Remove the old integration configuration
3. **Note:** Entity IDs may differ, so you'll need to update automations/dashboards

## Testing Recommendations

### Basic Functionality Testing

1. **Installation** - Verify integration installs without errors
2. **Configuration** - Test config flow completes successfully
3. **Data Collection** - Confirm sensors are created and updating
4. **VSN Model Detection** - Check that correct VSN model is detected

### Advanced Testing

1. **Scan Interval** - Test different polling frequencies
2. **Error Handling** - Test behavior when VSN is unreachable
3. **Reconfiguration** - Test changing host/credentials via reconfigure
4. **Multiple Inverters** - If applicable, verify all inverters are discovered

### Standalone Test Script

Use the `vsn_client.py` script for detailed testing:

```bash
cd custom_components/abb_fimer_pvi_vsn_rest
python vsn_client.py --host <your-vsn-ip> --username <user> --password <pass>
```

See `VSN_CLIENT_README.md` for detailed documentation.

## Known Issues

### Beta Release Limitations

- **Limited VSN700 Testing** - Primary testing done on VSN300 devices
- **Normalization Mapping** - Requires internet connection for first load (mapping fetched from GitHub)
- **Entity Naming** - Some entity names may not be optimal and could change in future releases
- **Device Info** - Basic device information; enhanced metadata planned for future release

### Reporting Issues

Please report any issues on GitHub:
- **Issues:** https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/issues
- **Discussions:** https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/discussions

## Technical Details

### Architecture

- **REST Client** (`vsn_client.py`)
  - Handles VSN300/VSN700 authentication
  - Manages API endpoint requests
  - Provides data normalization

- **Config Flow** (`config_flow.py`)
  - User-friendly setup wizard
  - VSN model auto-detection
  - Validation of credentials and connectivity

- **Coordinator** (`coordinator.py`)
  - Manages polling cycles
  - Handles errors and retries
  - Propagates updates to sensors

- **Sensor Platform** (`sensor.py`)
  - Dynamic entity creation
  - Entity metadata management
  - State and attribute handling

### Data Flow

1. Coordinator triggers update
2. REST client fetches data from VSN endpoints
3. Data normalized using VSN→SunSpec mapping
4. Sensors update with new values
5. Home Assistant UI reflects changes

## Documentation

- **[README.md](../../README.md)** - Installation and configuration guide
- **[CHANGELOG.md](../../CHANGELOG.md)** - Complete changelog
- **[CLAUDE.md](../../CLAUDE.md)** - Developer guidelines
- **[VSN_CLIENT_README.md](../../custom_components/abb_fimer_pvi_vsn_rest/VSN_CLIENT_README.md)** - Test script documentation

## Links

- **Full Changelog:** [v1.0.0-beta.1](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/blob/master/CHANGELOG.md#100-beta1---2025-10-26)
- **GitHub Release:** [v1.0.0-beta.1](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/releases/tag/v1.0.0-beta.1)
- **Repository:** https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest

## Acknowledgments

This integration builds upon the foundation of the `ha-abb-powerone-pvi-sunspec` integration, adapting it specifically for VSN datalogger REST API support.

---

**Feedback & Support:**
- Issues: https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/issues
- Discussions: https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/discussions

Generated with [Claude Code](https://claude.com/claude-code)
