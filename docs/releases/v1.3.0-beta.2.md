# Release Notes - v1.3.0-beta.2

**Release Date**: 2025-12-06

**Focus**: Bug Fix for Options Flow Error Message

**Status**: Beta Release

---

## Overview

This release fixes a confusing "Unknown error" message that appeared when saving configuration options.

Thanks to **@ivanfmartinez** for reporting this in
[Issue #19](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/issues/19).

---

## Bug Fixes

### "Unknown Error" on First Options Submit

**Problem**: When submitting configuration changes in the options flow, an "Unknown error" appeared on
first submit, but:

- Changes were actually saved correctly
- No error appeared in logs
- Clicking submit again showed success

**Root Cause**: The `async_reload_entry` function in `__init__.py` was incorrectly defined as a sync
function (`@callback def`) but Home Assistant's `add_update_listener` expects an async coroutine
(`async def`).

When Home Assistant tried to `await` the sync function, it failed - but by that point the options
were already saved, explaining the confusing behavior.

**Fix**: Changed function signature from sync to async:

```python
# Before (incorrect)
@callback
def async_reload_entry(hass, config_entry):
    ...

# After (correct)
async def async_reload_entry(hass, config_entry):
    ...
```

---

## Technical Details

### Files Modified

| File | Changes |
|------|---------|
| `__init__.py` | Removed `@callback` decorator, changed `def` to `async def` |

---

## Testing

After the fix:

- [ ] Options submit should show success immediately on first click
- [ ] No "Unknown error" message
- [ ] Integration reloads correctly with new options
- [ ] Debug log shows "Scheduling reload of config entry"

---

## Beta Testing

This is a **beta release**. Please report any issues at:
[GitHub Issues](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/issues)

---

## Upgrade Notes

This is a non-breaking bug fix release. Simply update to the latest version.

---

## Related Issues

- Fixes UI error reported by @ivanfmartinez in
  [Issue #19](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/issues/19)
