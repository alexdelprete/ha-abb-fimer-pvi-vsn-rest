# v1.0.0-beta.6 - Bug Fix Release

**Release Date:** 2025-01-27

Sixth beta release with critical bug fixes for v1.0.0-beta.5.

---

## üêõ Bug Fixes

### AttributeError in Sensor Initialization

Fixed critical AttributeError that prevented the integration from loading.

**Error Message:**
```
AttributeError: 'VSNSensor' object has no attribute '__attr_native_unit_of_measurement'.
Did you mean: '_attr_native_unit_of_measurement'?
```

**Root Cause:**
In the sensor initialization debug log ([sensor.py:182](custom_components/abb_fimer_pvi_vsn_rest/sensor.py#L182)), the code was directly accessing `self._attr_native_unit_of_measurement` without using `getattr()`. This attribute might not be set for all sensors (especially string sensors), causing an AttributeError during sensor creation.

**Fix:**
Changed to use `getattr()` with a default value for consistent handling:

```python
# Before:
self._attr_native_unit_of_measurement,

# After:
getattr(self, "_attr_native_unit_of_measurement", None),
```

**Result:**
- Integration now loads properly without AttributeError
- Consistent attribute access pattern in debug logging
- All sensors (numeric and string) initialize successfully

**Commit:** [51f9286](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/commit/51f9286)

---

### Ruff Linting (RET505)

Fixed Ruff linting error that caused GitHub Actions to fail.

**Issue:**
- **RET505**: Unnecessary `else` after `return` statement
- **Location**: [generate_mapping_excel.py:917](scripts/generate_mapping_excel.py#L917)

**Fix:**
Removed redundant `else` clause after `return` statement:

```python
# Before:
if model:
    return f"abb_{model.lower()}_{entity_id}"
else:
    return f"abb_vsn_{entity_id}"

# After:
if model:
    return f"abb_{model.lower()}_{entity_id}"
return f"abb_vsn_{entity_id}"
```

**Result:**
- GitHub Actions Ruff check now passes
- Cleaner, more Pythonic code
- No functional changes

**Commit:** [20a24fd](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/commit/20a24fd)

---

## üìã Technical Details

### Files Modified

**Component:**
- `custom_components/abb_fimer_pvi_vsn_rest/sensor.py` - Fixed AttributeError in debug log

**Scripts:**
- `scripts/generate_mapping_excel.py` - Removed unnecessary else clause

**Documentation:**
- `README.md` - Updated version to beta.6
- `CHANGELOG.md` - Documented bug fixes

### Commits

- [51f9286](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/commit/51f9286) - fix: Use getattr for _attr_native_unit_of_measurement in debug log
- [20a24fd](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/commit/20a24fd) - fix: Remove unnecessary else after return (RET505)

---

## üéØ Known Issues

- **Beta Release** - Please report any issues on [GitHub](https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/issues)
- **Breaking Changes from beta.5** - Entity IDs were updated in beta.5, migration required

---

## ‚¨ÜÔ∏è Upgrading from v1.0.0-beta.5

This is a **bug fix release** with no breaking changes. Simply update to beta.6:

### HACS
1. Go to HACS ‚Üí Integrations
2. Find "ABB/FIMER PVI VSN REST"
3. Click "Update"
4. Restart Home Assistant

### Manual
1. Download this release
2. Replace `custom_components/abb_fimer_pvi_vsn_rest` directory
3. Restart Home Assistant

**Note:** If you're upgrading from beta.4 or earlier, see [v1.0.0-beta.5 release notes](v1.0.0-beta.5.md) for breaking changes.

---

## üì• Installation

### HACS (Recommended)
1. Add custom repository: `https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest`
2. Install "ABB/FIMER PVI VSN REST"
3. Restart Home Assistant
4. Add integration via UI: Settings ‚Üí Devices & Services ‚Üí Add Integration

### Manual
1. Download `abb_fimer_pvi_vsn_rest.zip` from this release
2. Extract to `custom_components/`
3. Restart Home Assistant
4. Add integration via UI

---

## üôè Feedback

- **Issues**: https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/issues
- **Discussions**: https://github.com/alexdelprete/ha-abb-fimer-pvi-vsn-rest/discussions

---

ü§ñ Generated with [Claude Code](https://claude.com/claude-code)
